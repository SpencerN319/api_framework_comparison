from fastapi import (
	Body,
	status,
	APIRouter,
	Request
)
from .models import Vulnerability
from .vulnerability_service import new

router = APIRouter(
	prefix="/vulnerabilities",
	tags=["vulnerabilities"],
	responses={404: {"description": "Not found"}}
)


@router.post(
	path="",
	response_description="Create a new vulnerability",
	status_code=status.HTTP_200_OK,
	response_model=Vulnerability)
async def create(req: Request, vulnerability: Vulnerability = Body):
	return new(req, vulnerability)
