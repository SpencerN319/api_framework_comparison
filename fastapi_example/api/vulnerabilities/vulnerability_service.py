from fastapi.encoders import jsonable_encoder
from fastapi import Request
from .models import Vulnerability

DB = "vulnerabilities"


def new(req: Request, vulnerability: Vulnerability) -> Vulnerability:
	vulnerability = jsonable_encoder(vulnerability)
	req.app.database[DB].insert_one(vulnerability)
	return vulnerability
